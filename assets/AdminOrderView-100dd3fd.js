import{T as f}from"./Toast-835f3f23.js";import{D as y}from"./DelModal-aeaeaebc.js";import{M as P}from"./modal-d5c36580.js";import{_ as O,o as d,c as n,b as e,t as o,F as h,j as u,g as D,r as p,d as g,p as m,s as b}from"./index-c26ca672.js";const w={data(){return{modal:""}},props:["checkOrderData"],mounted(){this.modal=new P(this.$refs.orderModal),console.log(this.checkOrderData)},watch:{},methods:{hideModal(){console.log("hideModal"),this.modal.hide()},showModal(){console.log("showModal"),this.modal.show()}}},x={class:"modal fade",ref:"orderModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},C={class:"modal-dialog modal-lg"},V={class:"modal-content"},E=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"exampleModalLabel"},"訂單詳情"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),I={key:0,class:"modal-body"},A={class:"row"},T={class:"col"},B={class:"ms-3"},N=e("h4",null,"用戶資料",-1),R={class:"table"},U={class:"tbody"},j=e("th",{scope:"row"},"姓名",-1),S=e("th",{scope:"row"},"電話",-1),F=e("th",{scope:"row"},"email",-1),H=e("th",{scope:"row"},"付款方式",-1),q={class:"col"},z=e("h4",null,"訂單資料",-1),G={class:"table"},J={class:"tbody"},K=e("th",{scope:"row"},"訂單編號",-1),Q=e("th",{scope:"row"},"下單時間",-1),W=e("th",{scope:"row"},"總金額",-1),X=e("th",{scope:"row"},"訂購品項",-1),Y=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-primary text-white","data-bs-dismiss":"modal"}," 關閉 ")],-1);function Z(l,t,i,L,a,r){return d(),n("div",x,[e("div",C,[e("div",V,[E,i.checkOrderData.order?(d(),n("div",I,[e("div",A,[e("div",T,[e("div",B,[N,e("table",R,[e("div",U,[e("tr",null,[j,e("td",null,o(i.checkOrderData.order.user.name),1)]),e("tr",null,[S,e("td",null,o(i.checkOrderData.order.user.tel),1)]),e("tr",null,[F,e("td",null,o(i.checkOrderData.order.user.email),1)]),e("tr",null,[H,e("td",null,o(i.checkOrderData.order.user.payment),1)])])])])]),e("div",q,[z,e("table",G,[e("div",J,[e("tr",null,[K,e("td",null,o(i.checkOrderData.order.id),1)]),e("tr",null,[Q,e("td",null,o(new Date(i.checkOrderData.order.create_at*1e3).toLocaleDateString()),1)]),e("tr",null,[W,e("td",null,o(i.checkOrderData.order.total),1)]),e("tr",null,[X,e("td",null,[(d(!0),n(h,null,u(i.checkOrderData.order.products,_=>(d(),n("p",{key:_.id,class:"mb-0"},o(_.product.title),1))),128))])])])])])])])):D("",!0),Y])])],512)}const ee=O(w,[["render",Z]]),{VITE_APP_URL:v,VITE_APP_PATH:k}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"aurora-path",BASE_URL:"/vite-sideproject-w6/",MODE:"production",DEV:!1,PROD:!0},te={data(){return{delId:"",checkOrderData:{},allOrderList:[],isLoading:!1,currentPage:1}},components:{DelModal:y,OrderDetailModal:ee},mounted(){this.isLoading=!0,this.getOrderList()},methods:{getOrderList(l=1){this.isLoading=!0,this.$http.get(`${v}/api/${k}/admin/orders?page=${l}`).then(t=>{console.log(t.data),this.isLoading=!1,this.allOrderList=t.data}).catch(t=>{console.log(t),this.isLoading=!1,f.fire({icon:"error",title:t.response.data.message})})},changePage(l){console.log(l),this.currentPage=l,this.getOrderList(this.currentPage)},openDelModal(l){console.log("open"),console.log(l),this.delId=l;const t=this.$refs.deleteModal;console.log(t),t.showModal()},openOrderModal(l){this.isLoading=!0,console.log(l),this.$http.get(`${v}/api/${k}/order/${l}`).then(t=>{console.log(t.data),this.checkOrderData=t.data,this.isLoading=!1}).catch(t=>{console.log(t),this.isLoading=!1}),this.$refs.orderDetailModal.showModal()},delOrder(){console.log(this.delId);const l=this.delId;this.$http.delete(`${v}/api/${k}/admin/order/${l}`).then(t=>{console.log(t.data),this.getOrderList(this.currentPage),this.$refs.deleteModal.hideModal()}).catch(t=>{f.fire({icon:"error",title:t.response.data.message})})}}},se=e("h3",{class:"text-center mt-5"},"訂單管理",-1),oe={class:"card mt-4"},le={class:"card-body p-0"},ae={class:"table-responsive text-nowrap"},de={class:"table table-hover"},ne=e("thead",{class:"border-bottom border-3 bg-light"},[e("tr",{class:"align-middle"},[e("th",{scope:"col ",class:"ps-3"}),e("th",{scope:"col",class:"py-3"},"訂單編號"),e("th",{scope:"col"},"Email"),e("th",{scope:"col"},"用戶名"),e("th",{scope:"col"},"購買品項"),e("th",{scope:"col",class:"text-end"},"付款方式"),e("th",{scope:"col",class:"text-end"},"金額"),e("th",{scope:"col",class:"text-end pe-3"},"訂單編輯")])],-1),ie=e("td",{class:"py-3 ps-3"},[e("input",{class:"form-check-input",type:"checkbox",name:"",id:""})],-1),re={class:""},ce={class:"ps-2 px-0 mb-0"},he={class:"text-end"},_e={class:"text-end"},ue={class:"text-end pe-3 text-danger"},pe={class:"btn-group",role:"group"},ge=["onClick"],me=["onClick"],be={key:0,class:"card-footer bg-transparent border-0 pb-0"},ve={"aria-label":"Page navigation mb-0 "},ke={class:"pagination justify-content-center"},fe=e("a",{class:"page-link",href:"","aria-label":"Previous"},[e("span",{"aria-hidden":"true"},"«")],-1),Oe=[fe],De=["onClick"],Le={class:"page-link",href:"#"},Me=e("a",{class:"page-link",href:"#","aria-label":"Next"},[e("span",{"aria-hidden":"true"},"»")],-1),$e=[Me];function ye(l,t,i,L,a,r){const _=p("LoadingVue"),M=p("DelModal"),$=p("OrderDetailModal");return d(),n(h,null,[se,g(_,{active:a.isLoading,"onUpdate:active":t[0]||(t[0]=s=>a.isLoading=s)},null,8,["active"]),e("div",oe,[e("div",le,[e("div",ae,[e("table",de,[ne,e("tbody",null,[(d(!0),n(h,null,u(a.allOrderList.orders,s=>(d(),n("tr",{class:"align-middle",key:s.id},[ie,e("td",re,o(s.id),1),e("td",null,o(s.user.email),1),e("td",null,o(s.user.name),1),e("td",null,[e("ol",ce,[(d(!0),n(h,null,u(s.products,c=>(d(),n("li",{key:c.id},o(c.product.title),1))),128))])]),e("td",he,o(s.user.payment),1),e("td",_e,o(s.total),1),e("td",ue,[e("div",pe,[e("button",{onClick:c=>r.openOrderModal(s.id),type:"button",class:"btn btn-outline-dark btn-sm"}," 檢視 ",8,ge),e("button",{onClick:c=>r.openDelModal(s.id),type:"button",class:"btn btn-outline-primary btn-sm"}," 刪除 ",8,me)])])]))),128))])])])]),a.allOrderList.pagination?(d(),n("div",be,[e("nav",ve,[e("ul",ke,[e("li",{class:m(["page-item",{disabled:!a.allOrderList.pagination.has_pre}]),onClick:t[1]||(t[1]=b(s=>r.changePage(a.currentPage-1),["prevent"]))},Oe,2),(d(!0),n(h,null,u(a.allOrderList.pagination.total_pages,s=>(d(),n("li",{class:m(["page-item",{active:s===a.currentPage}]),key:s+"hlllq",onClick:b(c=>r.changePage(s),["prevent"])},[e("a",Le,o(s),1)],10,De))),128)),e("li",{class:m(["page-item",{disabled:!a.allOrderList.pagination.has_next}]),onClick:t[2]||(t[2]=b(s=>r.changePage(a.currentPage+1),["prevent"]))},$e,2)])])])):D("",!0)]),g(M,{onDelItem:r.delOrder,"del-id":a.delId,ref:"deleteModal"},null,8,["onDelItem","del-id"]),g($,{"check-order-data":a.checkOrderData,ref:"orderDetailModal"},null,8,["check-order-data"])],64)}const Ve=O(te,[["render",ye]]);export{Ve as default};
