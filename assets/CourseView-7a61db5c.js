import{_ as v,m as _,a as h,o as a,b as c,d as s,t as o,i,n as f,h as u,q as r,F as m,l as w}from"./index-0dad1233.js";import{c as b}from"./cartStore-f5332395.js";import{f as p}from"./frontOrderStore-6d8f25be.js";import{h as k}from"./zh-tw-a6f00c05.js";import"./Toast-187c6a56.js";const{VITE_APP_URL:g,VITE_APP_PATH:y}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"aurora-path",BASE_URL:"/vite-sideproject-w6/",MODE:"production",DEV:!1,PROD:!0},D={data(){return{activeItem:"",classId:this.$route.params.id,classData:{},currentCategory:"",similarClasses:[],checkBuyStatus:!1}},mounted(){this.classId=this.$route.params.id,this.getClassData(),this.getCartList()},computed:{..._(b,["cartList"]),..._(p,["showFinalStuOrderData"])},watch:{currentCategory(){this.getSmilarClassData()},cartList(){this.getCartList(),this.checkBuyStatus=this.cartList.carts.some(e=>e.product_id===this.classId)},showFinalStuOrderData(){this.matchStuNumAndClass(),this.matchFundingTarget()}},methods:{...h(b,["getCartList","addToCart"]),...h(p,["matchStuNumAndClass","matchFundingTarget","matchFundingMoney"]),countLeftDay(e){return Date.parse(new Date)>e?"已結束":(e=new Date(e).toISOString(),k(e).fromNow())},refreshPage(e){this.classId=e,this.$router.push(`/course/${e}`),this.getClassData(),this.getSmilarClassData(),window.scrollTo(0,0)},getClassData(){this.$http.get(`${g}/api/${y}/product/${this.classId}`).then(e=>{this.classData=e.data.product,this.currentCategory=e.data.product.category}).catch(()=>{this.$router.push("/notFound")})},getSmilarClassData(){this.$http.get(`${g}/api/${y}/products?category=${this.currentCategory}`).then(e=>{this.similarClasses=e.data.products.filter(l=>l.id!==this.classId)}).catch(e=>{console.log(e)})}}},x={class:"d-md-none fixed-bottom bg-white py-3"},I={class:"container"},T=s("button",{class:"btn w-25"},[s("i",{class:"bi bi-bookmark fs-3 fw-bold text-secondary"})],-1),S={key:0,class:"btn btn-primary w-75",href:"#/cart"},C={class:"container full-height"},L={class:"row my-3 g-3"},N={class:"col-md-7"},P={class:"ratio ratio-16x9 h-100"},B=["src"],E={key:0,class:"col-md-5 sticky-md-top",style:{top:"100px"}},F={class:"card h-100"},V={class:"card-body"},A={class:"w-25 badge bg-white text-primary border border-primary mb-3"},M=s("span",{class:"w-25 badge bg-secondary mb-3 ms-2"}," 募資中 ",-1),H={class:"bg-light p-3 my-3"},O={class:"text-muted mb-0"},U={class:"text-dark mb-2"},j={class:"fw-bold"},R={class:"progress"},z={class:"d-flex justify-content-between mt-2"},q={class:"mb-0"},G={class:"text-secondary fw-bold fs-5"},J={class:"mb-0"},K={class:"d-flex mt-3 py-3 justify-content-between",style:{background:"white"}},Q={class:"text-center w-50"},W={class:"mb-0"},X=s("br",null,null,-1),Y={class:"fs-4 fw-bold text-primary"},Z={class:"border-start text-center w-50"},$={class:"mb-0"},ss=s("br",null,null,-1),ts={class:"fs-4"},es=s("button",{class:"btn w-25"},[s("i",{class:"bi bi-bookmark fs-3 fw-bold text-secondary"})],-1),os={key:0,class:"btn btn-secondary w-75",href:"#/cart"},as={key:1,class:"col-md-5 sticky-md-top",style:{top:"100px"}},cs={class:"card h-100"},is={class:"card-body"},ls={class:"d-flex flex-column h-100"},ns={class:"d-flex"},rs={class:"w-25 badge bg-white text-primary border border-primary mb-3"},ds=s("span",{class:"w-25 badge bg-darkblue mb-3 ms-2"}," 已開課 ",-1),_s={class:"border-bottom mb-3"},hs={class:"h4 text-primary fw-bold my-3"},us={class:"ms-1 fs-6 text-muted fw-light"},ms=s("p",{class:"mb-3"},[s("i",{class:"bi bi-people-fill"}),i(" 同學 ?? 人")],-1),bs={class:"mb-1"},ps=s("i",{class:"bi bi-book"},null,-1),gs=s("i",{class:"bi bi-card-list"},null,-1),ys={class:"mt-auto"},vs=s("button",{class:"btn w-25"},[s("i",{class:"bi bi-bookmark fs-3 fw-bold text-secondary"})],-1),fs={key:0,class:"btn btn-primary text-white w-75",href:"#/cart"},ws={class:"col-md-7 mb-3"},ks={class:"card"},Ds={class:"card-body"},xs={class:"nav nav-tabs mb-3 sticky-top bg-white",style:{top:"95px"}},Is={class:"nav-item"},Ts={class:"nav-item"},Ss={class:"nav-item"},Cs=s("h4",{id:"classSection",name:"classSection",class:"text-secondary fw-bold"}," 課程章節 ",-1),Ls=["innerHTML"],Ns=s("h4",{id:"getSkill",class:"text-secondary fw-bold"},"收穫技能",-1),Ps=["innerHTML"],Bs=s("p",null,null,-1),Es=s("h4",{id:"teacherInfo",class:"text-secondary fw-bold"},"講師介紹",-1),Fs=["innerHTML"],Vs={class:"row g-3 my-5"},As=s("h4",{class:"text-secondary fw-bold"},"類似課程推薦...",-1),Ms=["onClick"],Hs={class:"row align-items-center g-0"},Os={class:"col-4 col-md-12"},Us={class:"ratio ratio-4x3 overflow-hidden"},js=["src"],Rs={class:"col-8 col-md-12"},zs={class:"card-body"},qs={class:"d-flex flex-column flex-lg-row justify-content-between align-items-lg-center"},Gs={class:"mb-0 text-muted"},Js=s("i",{class:"bi bi-book"},null,-1),Ks={class:"text-primary fw-bold fs-3 mb-0"},Qs=s("br",null,null,-1),Ws=s("br",null,null,-1),Xs=s("br",null,null,-1),Ys=s("br",null,null,-1),Zs=s("br",null,null,-1),$s=s("br",null,null,-1);function st(e,l,tt,et,t,d){return a(),c(m,null,[s("div",x,[s("div",I,[T,t.checkBuyStatus?(a(),c("a",S," 已購買，結帳去 ")):(a(),c("button",{key:1,onClick:l[0]||(l[0]=n=>e.addToCart(t.classData.id)),class:"btn btn-outline-primary w-75"}," 立即購買 "))])]),s("div",C,[s("div",L,[s("div",N,[s("div",P,[s("img",{style:{"background-position":"bottom"},class:"img-cover",src:t.classData.imageUrl,alt:""},null,8,B)])]),t.classData.courseStatus==="classFunding"?(a(),c("div",E,[s("div",F,[s("div",V,[s("span",A,o(t.classData.category),1),M,s("h4",null,o(t.classData.title),1),s("div",H,[s("p",O," 募資達標門檻 NT$ "+o(t.classData.funding_target),1),s("p",U,[i(" 已募資金額 "),s("span",j," NT$ "+o(e.matchFundingMoney(t.classData.id)),1)]),s("div",R,[s("div",{class:"progress-bar progress-bar-striped progress-bar-animated",role:"progressbar","aria-valuenow":"75","aria-valuemin":"0","aria-valuemax":"100",style:f({width:e.matchFundingTarget(t.classData.id)+"%"})},null,4)]),i(" 達標率 "+o(e.matchFundingTarget(t.classData.id))+"% ",1),s("div",z,[s("p",q,[i(" 募資倒數 "),s("span",G,o(d.countLeftDay(t.classData.fundingEndDate)),1)]),s("p",J," 同學 "+o(e.matchStuNumAndClass(t.classData.id))+" 人 ",1)]),s("div",K,[s("div",Q,[s("p",W,[i(" 募資優惠價 "),X,s("span",Y," NT$ "+o(t.classData.funding_price),1)])]),s("div",Z,[s("p",$,[i(" 正式售價 "),ss,s("del",ts," NT$ "+o(t.classData.price),1)])])])]),s("div",null,[es,t.checkBuyStatus?(a(),c("a",os," 已購買，結帳去 ")):(a(),c("button",{key:1,onClick:l[1]||(l[1]=n=>e.addToCart(t.classData.id)),class:"btn btn-outline-primary w-75"}," 立即購買 "))])])])])):u("",!0),t.classData.courseStatus==="classOpen"?(a(),c("div",as,[s("div",cs,[s("div",is,[s("div",ls,[s("div",ns,[s("span",rs,o(t.classData.category),1),ds]),s("div",_s,[s("h4",null,o(t.classData.title),1),s("p",hs,[i(" NT$ "+o(t.classData.price)+" ",1),s("del",us," NT$ "+o(t.classData.origin_price),1)]),ms]),s("p",bs,[ps,i(" 課程總時數："+o(t.classData.unit)+" 小時 ",1)]),s("p",null,[gs,i(" 章節單元數："+o(t.classData.classSectionNum)+" 章節 "+o(t.classData.classUnitNum)+" 單元 ",1)]),s("div",ys,[vs,t.checkBuyStatus?(a(),c("a",fs," 已購買，結帳去 ")):(a(),c("button",{key:1,onClick:l[2]||(l[2]=n=>e.addToCart(t.classData.id)),class:"btn btn-outline-primary w-75"}," 立即購買 "))])])])])])):u("",!0),s("div",ws,[s("div",ks,[s("div",Ds,[s("ul",xs,[s("li",Is,[s("a",{class:r([{active:t.activeItem==="course"},"nav-link fw-bold"]),onclick:"{document.getElementById('classSection').scrollIntoView(),activeItem='course'}"},"課程章節",2)]),s("li",Ts,[s("a",{class:r([{active:t.activeItem==="skillTree"},"nav-link fw-bold"]),onclick:"{document.getElementById('getSkill').scrollIntoView() ,activeItem='skillTree'}"},"收穫技能",2)]),s("li",Ss,[s("a",{class:r([{active:t.activeItem==="teacherInfo"},"nav-link fw-bold"]),onclick:"{document.getElementById('teacherInfo').scrollIntoView(),activeItem='teacherInfo'}"},"講師介紹",2)])]),s("div",null,[Cs,s("div",{innerHTML:t.classData.content,class:"border-bottom mb-3"},null,8,Ls),Ns,s("div",{innerHTML:t.classData.skillTree,class:"border-bottom mb-3"},null,8,Ps),Bs,Es,s("div",{innerHTML:t.classData.teacherInfo,class:"mb-3"},null,8,Fs)])])])])]),s("div",Vs,[As,(a(!0),c(m,null,w(t.similarClasses,n=>(a(),c("div",{class:"col-md-4",key:n.id},[s("div",{class:"card hover-pointer",onClick:ot=>d.refreshPage(n.id)},[s("div",Hs,[s("div",Os,[s("div",Us,[s("img",{src:n.imageUrl,class:"card-img-top img-cover p-2 p-md-0 img-hover-enlarge",alt:"..."},null,8,js)])]),s("div",Rs,[s("div",zs,[s("h5",null,o(n.title),1),s("div",qs,[s("p",Gs,[Js,i(" 課程時數 "+o(n.unit)+" 小時 ",1)]),s("p",Ks," NT$ "+o(n.price),1)])])])])],8,Ms)]))),128))]),Qs,Ws,Xs,Ys,Zs,$s])],64)}const rt=v(D,[["render",st]]);export{rt as default};
