import{T as h}from"./Toast-bce8a41a.js";import{c as _}from"./cartStore-856056c6.js";import{_ as k,m as y,d as v,r as g,o as n,c,e as x,a as t,k as p,t as a,j as i,F as m,D as T,I as w,w as I,v as V,E as D,f as P}from"./index-1873f96c.js";const{VITE_APP_URL:b,VITE_APP_PATH:f}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"aurora-path",BASE_URL:"/vite-sideproject-w6/",MODE:"production",DEV:!1,PROD:!0},R={data(){return{isLoading:!1,couponCode:"",couponResText:""}},mounted(){this.getCartList(),this.fillInCouponData()},computed:{...y(_,["cartList","showCheck"])},watch:{cartList(){console.log(this.cartList)}},methods:{fillInCouponData(){if(console.log(localStorage.getItem("coupon")),localStorage.getItem("coupon")===null){h.fire({icon:"error",title:"尚未取得優惠券"});return}this.couponCode=localStorage.getItem("coupon");const o={code:this.couponCode};this.$http.post(`${b}/api/${f}/coupon`,{data:o}).then(s=>{console.log(s),this.couponResText=s.data.message,this.cartList.final_total=s.data.data.final_total}).catch(s=>{console.log(s)})},removeCoupon(){this.couponCode=""},delCartItem(o,s){console.log("id",o),console.log("productId",s),console.log(this.showCheck);const d=this.showCheck.indexOf(s);console.log(d),this.showCheck.splice(d,1),console.log(this.showCheck),this.$http.delete(`${b}/api/${f}/cart/${o}`).then(r=>{h.fire({icon:"success",title:r.data.message}),this.getCartList()}).catch(r=>{h.fire({icon:"error",title:r.response.data.message})})},...v(_,["getCartList"])}},E={class:"container"},S={class:"my-5"},A={key:0,class:"fs-6 text-darkblue fw-bold"},N={class:"row g-4"},B={class:"col-md-8"},U={key:0},$={class:"table"},O=t("thead",null,[t("tr",null,[t("th",{scope:"col"}),t("th",{scope:"col"},"課程名稱"),t("th",{scope:"col"},"課程狀態"),t("th",{scope:"col"},"售價"),t("th",{scope:"col",class:"text-end"},"付款金額")])],-1),F={key:0},j=t("td",{colspan:"5",class:"text-center"},[p(" 購物車尚無商品 "),t("br"),t("a",{href:"#/courses",class:"btn btn-outline-primary my-2"}," 探索課程 ")],-1),H=[j],M=["onClick"],z=t("i",{class:"bi bi-trash3"},null,-1),q=[z],G={key:0},J={key:1},K={class:"text-end"},Q={class:"col-md-4"},W={key:0},X={class:"bg-light p-3"},Y=t("h5",{class:"text-center border-bottom py-3"},"訂單明細",-1),Z={class:"clear-fix"},tt=t("p",{class:"d-inline"},"小計",-1),ot={class:"d-inline float-end"},st={class:"text-primary text-end border-bottom py-3"},et=t("br",null,null,-1),nt={class:"text-end"},ct={class:"input-group"},at=t("span",{class:"input-group-text",id:"discount"},"使用優惠券",-1),lt={key:0,class:"fs-7 text-end text-muted mb-0"},it={key:1,class:"btn btn-outline-primary w-100 disabled mt-4",type:"button"},rt=t("br",null,null,-1),dt=t("br",null,null,-1),ut=t("br",null,null,-1);function ht(o,s,d,r,l,u){const C=g("LoadingVue"),L=g("RouterLink");return n(),c(m,null,[x(C,{active:l.isLoading,"onUpdate:active":s[0]||(s[0]=e=>l.isLoading=e)},null,8,["active"]),t("div",E,[t("h3",S,[p(" 購物車 "),o.cartList.carts?(n(),c("span",A," 目前有 "+a(o.cartList.carts.length)+" 門課程 ",1)):i("",!0)]),t("div",N,[t("div",B,[o.cartList.carts?(n(),c("div",U,[t("table",$,[O,t("tbody",null,[o.cartList.carts.length===0?(n(),c("tr",F,H)):i("",!0),(n(!0),c(m,null,T(o.cartList.carts,e=>(n(),c("tr",{key:e.id},[t("td",null,[t("a",{onClick:pt=>u.delCartItem(e.id,e.product_id),class:"link-primary"},q,8,M)]),t("td",null,a(e.product.title),1),e.product.courseStatus==="classFunding"?(n(),c("td",G," 募資中 ")):e.product.courseStatus==="classOpen"?(n(),c("td",J," 已開課 ")):i("",!0),t("td",null,a(e.product.origin_price),1),t("td",K,a(e.product.price),1)]))),128))])])])):i("",!0)]),t("div",Q,[o.cartList.carts?(n(),c("div",W,[t("div",X,[Y,t("div",Z,[tt,t("p",ot,[t("del",null," NT$ "+a(o.cartList.total),1)])]),t("h4",st," NT$ "+a(o.cartList.final_total),1),et,t("div",nt,[t("span",{onClick:s[1]||(s[1]=(...e)=>u.fillInCouponData&&u.fillInCouponData(...e)),class:w([{disabled:o.cartList.carts.length===0},"badge bg-secondary btn mb-2"])},"一鍵帶入",2)]),t("div",ct,[at,I(t("input",{"onUpdate:modelValue":s[2]||(s[2]=e=>l.couponCode=e),type:"text",class:"form-control",placeholder:"輸入代碼"},null,512),[[V,l.couponCode]])]),l.couponResText!==""?(n(),c("p",lt,a(l.couponResText),1)):i("",!0),o.cartList.carts.length===0?(n(),c("button",it," 未選購任何課程 ")):(n(),D(L,{key:2,to:"./cart/order",class:"btn btn-outline-primary w-100 mt-4",type:"button"},{default:P(()=>[p(" 結帳去 ")]),_:1}))])])):i("",!0)])])]),rt,dt,ut],64)}const bt=k(R,[["render",ht]]);export{bt as default};
