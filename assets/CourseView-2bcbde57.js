import{h as w}from"./zh-tw-a6f00c05.js";import{_ as D,m as d,d as h,o as l,c as n,a as s,t as a,l as c,H as S,k as b,J as m,F as g,E as C}from"./index-4afa8807.js";import{c as p}from"./cartStore-b1db94c8.js";import{f as k}from"./frontOrderStore-14033aa5.js";import{b as y}from"./bookmarkStore-fd2cead1.js";import"./Toast-e4cc08f6.js";const{VITE_APP_URL:v,VITE_APP_PATH:f}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"aurora-path",BASE_URL:"/vue-learnFund/",MODE:"production",DEV:!1,PROD:!0},T={data(){return{activeItem:"",classId:this.$route.params.id,classData:{},currentCategory:"",similarClasses:[],checkBuyStatus:!1}},mounted(){this.classId=this.$route.params.id,this.getClassData(),this.getCartList(),this.getStuOrderList()},computed:{...d(p,["cartList"]),...d(k,["showFinalStuOrderData"]),...d(y,["showbookmarkData"])},watch:{showbookmarkData(){this.setLocalStorageBookmark()},currentCategory(){this.getSmilarClassData()},cartList(){this.checkBuyStatus=this.cartList.carts.some(o=>o.product_id===this.classId)},showFinalStuOrderData(){this.matchStuNumAndClass(),this.matchFundingTarget()}},methods:{...h(p,["getCartList","addToCart"]),...h(k,["getStuOrderList","matchStuNumAndClass","matchFundingTarget","matchFundingMoney"]),...h(y,["setLocalStorageBookmark","getLocalStorageBookmark","BookmarkAction"]),scrollScreen(o){const e=document.getElementById(o).getBoundingClientRect(),u=window.pageYOffset||document.documentElement.scrollTop,_=e.top+u;window.scrollTo(0,_-200)},countLeftDay(o){return Date.parse(new Date)>o?"已結束":(o=new Date(o).toISOString(),w(o).fromNow())},refreshPage(o){this.classId=o,this.$router.push(`/course/${o}`),this.getClassData(),this.getSmilarClassData(),window.scrollTo(0,0)},getClassData(){this.$http.get(`${v}/api/${f}/product/${this.classId}`).then(o=>{this.classData=o.data.product,this.currentCategory=o.data.product.category}).catch(()=>{this.$router.push("/notFound")})},getSmilarClassData(){this.$http.get(`${v}/api/${f}/products?category=${this.currentCategory}`).then(o=>{this.similarClasses=o.data.products.filter(e=>e.id!==this.classId)}).catch(o=>{console.log(o)})}}},I={class:"d-md-none fixed-bottom py-2 shadow-lg bg-light"},x={class:"container"},L={class:"btn w-25",type:"button"},B={key:0,class:"btn btn-primary w-75",href:"#/cart"},A={class:"container full-height"},N={class:"row my-3 g-3"},F={class:"col-md-7"},P={class:"ratio ratio-16x9 h-100"},E=["src"],O={key:0,class:"col-md-5 sticky-md-top",style:{top:"100px"}},H={class:"card h-100"},M={class:"card-body"},V={class:"w-25 badge bg-white text-primary border border-primary mb-3"},z=s("span",{class:"w-25 badge bg-secondary mb-3 ms-2"}," 募資中 ",-1),U={class:"bg-light p-3 my-3"},R={class:"text-muted mb-0"},j={class:"text-dark mb-2"},J={class:"fw-bold"},Y={class:"progress"},q={class:"d-flex justify-content-between mt-2"},G={class:"mb-0"},K={class:"text-secondary fw-bold fs-5"},Q={class:"mb-0"},W={class:"d-flex mt-3 py-3 justify-content-between",style:{background:"white"}},X={class:"text-center w-50"},Z={class:"mb-0"},$=s("br",null,null,-1),ss={class:"fs-4 fw-bold text-primary"},ts={class:"border-start text-center w-50"},os={class:"mb-0"},es=s("br",null,null,-1),as={class:"fs-4"},is={class:"btn w-25",type:"button"},ls={key:0,class:"btn btn-primary w-75",href:"#/cart"},ns={key:1,class:"col-md-5 sticky-md-top",style:{top:"100px"}},cs={class:"card h-100"},rs={class:"card-body"},ds={class:"d-flex flex-column h-100"},hs={class:"d-flex"},ms={class:"w-25 badge bg-white text-primary border border-primary mb-3"},us=s("span",{class:"w-25 badge bg-darkblue mb-3 ms-2"}," 已開課 ",-1),_s={class:"border-bottom mb-3"},bs={class:"h4 text-primary fw-bold my-3"},gs={class:"ms-1 fs-6 text-muted fw-light"},ps={class:"mb-3"},ks=s("i",{class:"bi bi-people-fill"},null,-1),ys={class:"mb-1"},vs=s("i",{class:"bi bi-book"},null,-1),fs=s("i",{class:"bi bi-card-list"},null,-1),ws={class:"mt-auto"},Ds={class:"btn w-25",type:"button"},Ss={key:0,class:"btn btn-primary text-white w-75",href:"#/cart"},Cs={class:"col-md-7 mb-3"},Ts={class:"card"},Is={class:"card-body"},xs={class:"nav nav-tabs mb-3 sticky-top bg-white",style:{top:"95px"}},Ls={class:"nav-item"},Bs={class:"nav-item"},As={class:"nav-item"},Ns=s("h4",{id:"classSection",name:"classSection",class:"text-secondary fw-bold"}," 課程章節 ",-1),Fs=["innerHTML"],Ps=s("h4",{id:"getSkill",class:"text-secondary fw-bold"},"收穫技能",-1),Es=["innerHTML"],Os=s("p",null,null,-1),Hs=s("h4",{id:"teacherInfo",class:"text-secondary fw-bold"},"講師介紹",-1),Ms=["innerHTML"],Vs={class:"row g-3 my-5"},zs=s("h4",{class:"text-secondary fw-bold"},"類似課程推薦...",-1),Us=["onClick"],Rs={class:"row align-items-center g-0"},js={class:"col-4 col-md-12"},Js={class:"ratio ratio-4x3 overflow-hidden"},Ys=["src"],qs={class:"col-8 col-md-12"},Gs={class:"h-100 d-flex flex-column"},Ks={class:"card-body"},Qs={class:"truncate"},Ws={class:"d-flex flex-column mt-auto flex-lg-row justify-content-between align-items-lg-center"},Xs={class:"mb-0 text-muted"},Zs=s("i",{class:"bi bi-book"},null,-1),$s={class:"text-primary fw-bold fs-3 mb-0"},st=s("br",null,null,-1),tt=s("br",null,null,-1),ot=s("br",null,null,-1),et=s("br",null,null,-1),at=s("br",null,null,-1),it=s("br",null,null,-1);function lt(o,e,u,_,t,r){return l(),n(g,null,[s("div",I,[s("div",x,[s("button",L,[o.showbookmarkData.includes(t.classData.id)?(l(),n("i",{key:0,class:"bi bi-bookmark-fill img-hover-enlarge",onClick:e[0]||(e[0]=i=>o.BookmarkAction(t.classData.id)),style:{"font-size":"1.5rem",color:"orange","font-weight":"500",cursor:"pointer"}})):(l(),n("i",{key:1,class:"bi bi-bookmark img-hover-enlarge",onClick:e[1]||(e[1]=i=>o.BookmarkAction(t.classData.id)),style:{"font-size":"1.5rem",color:"orange","font-weight":"500",cursor:"pointer"}}))]),t.checkBuyStatus?(l(),n("a",B," 已購買，結帳去 ")):(l(),n("button",{key:1,onClick:e[2]||(e[2]=i=>o.addToCart(t.classData.id)),class:"btn btn-outline-primary w-75",type:"button"}," 加入購物車 "))])]),s("div",A,[s("div",N,[s("div",F,[s("div",P,[s("img",{style:{"background-position":"bottom"},class:"img-cover",src:t.classData.imageUrl,alt:""},null,8,E)])]),t.classData.courseStatus==="classFunding"?(l(),n("div",O,[s("div",H,[s("div",M,[s("span",V,a(t.classData.category),1),z,s("h4",null,a(t.classData.title),1),s("div",U,[s("p",R," 募資達標門檻 NT$ "+a(t.classData.funding_target),1),s("p",j,[c(" 已募資金額 "),s("span",J," NT$ "+a(o.matchFundingMoney(t.classData.id)),1)]),s("div",Y,[s("div",{class:"progress-bar progress-bar-striped progress-bar-animated",role:"progressbar","aria-valuenow":"75","aria-valuemin":"0","aria-valuemax":"100",style:S({width:o.matchFundingTarget(t.classData.id)+"%"})},null,4)]),c(" 達標率 "+a(o.matchFundingTarget(t.classData.id))+"% ",1),s("div",q,[s("p",G,[c(" 募資倒數 "),s("span",K,a(r.countLeftDay(t.classData.fundingEndDate)),1)]),s("p",Q," 同學 "+a(o.matchStuNumAndClass(t.classData.id))+" 人 ",1)]),s("div",W,[s("div",X,[s("p",Z,[c(" 募資優惠價 "),$,s("span",ss," NT$ "+a(t.classData.funding_price),1)])]),s("div",ts,[s("p",os,[c(" 正式售價 "),es,s("del",as," NT$ "+a(t.classData.origin_price),1)])])])]),s("div",null,[s("button",is,[o.showbookmarkData.includes(t.classData.id)?(l(),n("i",{key:0,class:"bi bi-bookmark-fill img-hover-enlarge",onClick:e[3]||(e[3]=i=>o.BookmarkAction(t.classData.id)),style:{"font-size":"1.5rem",color:"orange","font-weight":"500",cursor:"pointer"}})):(l(),n("i",{key:1,class:"bi bi-bookmark img-hover-enlarge",onClick:e[4]||(e[4]=i=>o.BookmarkAction(t.classData.id)),style:{"font-size":"1.5rem",color:"orange","font-weight":"500",cursor:"pointer"}}))]),t.checkBuyStatus?(l(),n("a",ls," 已購買，結帳去 ")):(l(),n("button",{key:1,onClick:e[5]||(e[5]=i=>o.addToCart(t.classData.id)),class:"btn btn-outline-primary w-75",type:"button"}," 加入購物車 "))])])])])):b("",!0),t.classData.courseStatus==="classOpen"?(l(),n("div",ns,[s("div",cs,[s("div",rs,[s("div",ds,[s("div",hs,[s("span",ms,a(t.classData.category),1),us]),s("div",_s,[s("h4",null,a(t.classData.title),1),s("p",bs,[c(" NT$ "+a(t.classData.price)+" ",1),s("del",gs," NT$ "+a(t.classData.origin_price),1)]),s("p",ps,[ks,c(" 同學 "+a(o.matchStuNumAndClass(t.classData.id))+" 人 ",1)])]),s("p",ys,[vs,c(" 課程總時數："+a(t.classData.unit)+" 小時 ",1)]),s("p",null,[fs,c(" 章節單元數："+a(t.classData.classSectionNum)+" 章節 "+a(t.classData.classUnitNum)+" 單元 ",1)]),s("div",ws,[s("button",Ds,[o.showbookmarkData.includes(t.classData.id)?(l(),n("i",{key:0,class:"bi bi-bookmark-fill img-hover-enlarge",onClick:e[6]||(e[6]=i=>o.BookmarkAction(t.classData.id)),style:{"font-size":"1.5rem",color:"orange","font-weight":"500",cursor:"pointer"}})):(l(),n("i",{key:1,class:"bi bi-bookmark img-hover-enlarge",onClick:e[7]||(e[7]=i=>o.BookmarkAction(t.classData.id)),style:{"font-size":"1.5rem",color:"orange","font-weight":"500",cursor:"pointer"}}))]),t.checkBuyStatus?(l(),n("a",Ss," 已購買，結帳去 ")):(l(),n("button",{key:1,onClick:e[8]||(e[8]=i=>o.addToCart(t.classData.id)),class:"btn btn-outline-primary w-75",type:"button"}," 加入購物車 "))])])])])])):b("",!0),s("div",Cs,[s("div",Ts,[s("div",Is,[s("ul",xs,[s("li",Ls,[s("a",{class:m([{active:t.activeItem==="course"},"nav-link fw-bold"]),onClick:e[9]||(e[9]=i=>{r.scrollScreen("classSection"),t.activeItem="course"})},"課程章節",2)]),s("li",Bs,[s("a",{class:m([{active:t.activeItem==="skillTree"},"nav-link fw-bold"]),onClick:e[10]||(e[10]=i=>{r.scrollScreen("getSkill"),t.activeItem="skillTree"})},"收穫技能",2)]),s("li",As,[s("a",{class:m([{active:t.activeItem==="teacherInfo"},"nav-link fw-bold"]),onClick:e[11]||(e[11]=i=>{r.scrollScreen("teacherInfo"),t.activeItem="teacherInfo"})},"講師介紹",2)])]),s("div",null,[Ns,s("div",{innerHTML:t.classData.content,class:"border-bottom mb-3"},null,8,Fs),Ps,s("div",{innerHTML:t.classData.skillTree,class:"border-bottom mb-3"},null,8,Es),Os,Hs,s("div",{innerHTML:t.classData.teacherInfo,class:"mb-3"},null,8,Ms)])])])])]),s("div",Vs,[zs,(l(!0),n(g,null,C(t.similarClasses,i=>(l(),n("div",{class:"col-md-4",key:i.id},[s("div",{class:"card h-100 hover-pointer",onClick:nt=>r.refreshPage(i.id)},[s("div",Rs,[s("div",js,[s("div",Js,[s("img",{src:i.imageUrl,class:"card-img-top img-cover p-2 p-md-0 img-hover-enlarge",alt:"..."},null,8,Ys)])]),s("div",qs,[s("div",Gs,[s("div",Ks,[s("h5",Qs,a(i.title),1),s("div",Ws,[s("p",Xs,[Zs,c(" 課程時數 "+a(i.unit)+" 小時 ",1)]),s("p",$s," NT$ "+a(i.price),1)])])])])])],8,Us)]))),128))]),st,tt,ot,et,at,it])],64)}const _t=D(T,[["render",lt]]);export{_t as default};
