import{T as p}from"./Toast-ccf83d12.js";import{D as P}from"./DelModal-5e7430cf.js";import{M as y}from"./modal-955d26e2.js";import{_ as O,o as l,c as d,a as e,t as o,F as h,E as u,k as D,r as m,e as g,J as b,h as k}from"./index-d88e7fd2.js";import"./base-component-eb2a8843.js";const x={data(){return{modal:""}},props:["checkOrderData"],mounted(){this.modal=new y(this.$refs.orderModal)},watch:{},methods:{hideModal(){this.modal.hide()},showModal(){this.modal.show()}}},w={class:"modal fade",ref:"orderModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},C={class:"modal-dialog modal-lg"},V={class:"modal-content"},E=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"exampleModalLabel"},"訂單詳情"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),I={key:0,class:"modal-body"},A={class:"row"},T={class:"col"},N={class:"ms-3"},B=e("h4",null,"用戶資料",-1),R={class:"table"},S={class:"tbody"},U=e("th",{scope:"row"},"姓名",-1),F=e("th",{scope:"row"},"電話",-1),H=e("th",{scope:"row"},"email",-1),j=e("th",{scope:"row"},"付款方式",-1),q={class:"col"},z=e("h4",null,"訂單資料",-1),J={class:"table"},G={class:"tbody"},K=e("th",{scope:"row"},"訂單編號",-1),Q=e("th",{scope:"row"},"下單時間",-1),W=e("th",{scope:"row"},"總金額",-1),X=e("th",{scope:"row"},"訂購品項",-1),Y=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-primary text-white","data-bs-dismiss":"modal"}," 關閉 ")],-1);function Z(n,s,r,L,a,i){return l(),d("div",w,[e("div",C,[e("div",V,[E,r.checkOrderData.order?(l(),d("div",I,[e("div",A,[e("div",T,[e("div",N,[B,e("table",R,[e("div",S,[e("tr",null,[U,e("td",null,o(r.checkOrderData.order.user.name),1)]),e("tr",null,[F,e("td",null,o(r.checkOrderData.order.user.tel),1)]),e("tr",null,[H,e("td",null,o(r.checkOrderData.order.user.email),1)]),e("tr",null,[j,e("td",null,o(r.checkOrderData.order.user.payment),1)])])])])]),e("div",q,[z,e("table",J,[e("div",G,[e("tr",null,[K,e("td",null,o(r.checkOrderData.order.id),1)]),e("tr",null,[Q,e("td",null,o(new Date(r.checkOrderData.order.create_at*1e3).toLocaleDateString()),1)]),e("tr",null,[W,e("td",null,o(r.checkOrderData.order.total),1)]),e("tr",null,[X,e("td",null,[(l(!0),d(h,null,u(r.checkOrderData.order.products,_=>(l(),d("p",{key:_.id,class:"mb-0"},o(_.product.title),1))),128))])])])])])])])):D("",!0),Y])])],512)}const ee=O(x,[["render",Z]]),{VITE_APP_URL:v,VITE_APP_PATH:f}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"aurora-path",BASE_URL:"/vue-learnFund/",MODE:"production",DEV:!1,PROD:!0},te={data(){return{delId:"",checkOrderData:{},allOrderList:[],isLoading:!1,currentPage:1,totalOrderList:[],totalPage:1,courseStudentNumData:{}}},components:{DelModal:P,OrderDetailModal:ee},mounted(){this.getOrderList()},methods:{getOrderList(n=1){this.isLoading=!0,this.$http.get(`${v}/api/${f}/admin/orders?page=${n}`).then(s=>{this.isLoading=!1,p.fire({icon:"success",title:"成功取得資料"}),this.allOrderList=s.data,this.totalPage=s.data.pagination.total_pages,console.log(this.totalPage),console.log(this.allOrderList)}).catch(s=>{this.isLoading=!1,p.fire({icon:"error",title:s.response.data.message})})},changePage(n){this.currentPage=n,this.getOrderList(this.currentPage)},openDelModal(n){this.delId=n,this.$refs.deleteModal.showModal()},openOrderModal(n){this.isLoading=!0,this.$http.get(`${v}/api/${f}/order/${n}`).then(s=>{this.checkOrderData=s.data,this.isLoading=!1}).catch(()=>{this.isLoading=!1}),this.$refs.orderDetailModal.showModal()},delOrder(){const n=this.delId;this.$http.delete(`${v}/api/${f}/admin/order/${n}`).then(()=>{this.getOrderList(this.currentPage),this.$refs.deleteModal.hideModal()}).catch(s=>{p.fire({icon:"error",title:s.response.data.message})})}}},se=e("h3",{class:"text-center mt-5"},"訂單管理",-1),oe={class:"card mt-4"},ae={class:"card-body p-0"},le={class:"table-responsive text-nowrap"},de={class:"table table-hover"},ne=e("thead",{class:"border-bottom border-3 bg-light"},[e("tr",{class:"align-middle"},[e("th",{scope:"col ",class:"ps-3"}),e("th",{scope:"col",class:"py-3"},"訂單編號"),e("th",{scope:"col"},"Email"),e("th",{scope:"col"},"用戶名"),e("th",{scope:"col"},"購買品項"),e("th",{scope:"col",class:"text-end"},"付款方式"),e("th",{scope:"col",class:"text-end"},"金額"),e("th",{scope:"col",class:"text-end pe-3"},"訂單編輯")])],-1),re=e("td",{class:"py-3 ps-3"},[e("input",{class:"form-check-input",type:"checkbox",name:"",id:""})],-1),ie={class:""},ce={class:"ps-2 px-0 mb-0"},he={class:"text-end"},_e={class:"text-end"},ue={class:"text-end pe-3 text-danger"},pe={class:"btn-group",role:"group"},me=["onClick"],ge=["onClick"],be={key:0,class:"card-footer bg-transparent border-0 pb-0"},ke={"aria-label":"Page navigation mb-0 "},ve={class:"pagination justify-content-center"},fe=e("a",{class:"page-link",href:"","aria-label":"Previous"},[e("span",{"aria-hidden":"true"},"«")],-1),Oe=[fe],De=["onClick"],Le={class:"page-link",href:"#"},Me=e("a",{class:"page-link",href:"#","aria-label":"Next"},[e("span",{"aria-hidden":"true"},"»")],-1),$e=[Me];function Pe(n,s,r,L,a,i){const _=m("LoadingVue"),M=m("DelModal"),$=m("OrderDetailModal");return l(),d(h,null,[se,g(_,{active:a.isLoading,"onUpdate:active":s[0]||(s[0]=t=>a.isLoading=t)},null,8,["active"]),e("div",oe,[e("div",ae,[e("div",le,[e("table",de,[ne,e("tbody",null,[(l(!0),d(h,null,u(a.allOrderList.orders,t=>(l(),d("tr",{class:"align-middle",key:t.id},[re,e("td",ie,o(t.id),1),e("td",null,o(t.user.email),1),e("td",null,o(t.user.name),1),e("td",null,[e("ol",ce,[(l(!0),d(h,null,u(t.products,c=>(l(),d("li",{key:c.id},o(c.product.title),1))),128))])]),e("td",he,o(t.user.payment),1),e("td",_e,o(t.total),1),e("td",ue,[e("div",pe,[e("button",{onClick:c=>i.openOrderModal(t.id),type:"button",class:"btn btn-outline-dark btn-sm"}," 檢視 ",8,me),e("button",{onClick:c=>i.openDelModal(t.id),type:"button",class:"btn btn-outline-primary btn-sm"}," 刪除 ",8,ge)])])]))),128))])])])]),a.allOrderList.pagination?(l(),d("div",be,[e("nav",ke,[e("ul",ve,[e("li",{class:b(["page-item",{disabled:!a.allOrderList.pagination.has_pre}]),onClick:s[1]||(s[1]=k(t=>i.changePage(a.currentPage-1),["prevent"]))},Oe,2),(l(!0),d(h,null,u(a.allOrderList.pagination.total_pages,t=>(l(),d("li",{class:b(["page-item",{active:t===a.currentPage}]),key:t+"hlllq",onClick:k(c=>i.changePage(t),["prevent"])},[e("a",Le,o(t),1)],10,De))),128)),e("li",{class:b(["page-item",{disabled:!a.allOrderList.pagination.has_next}]),onClick:s[2]||(s[2]=k(t=>i.changePage(a.currentPage+1),["prevent"]))},$e,2)])])])):D("",!0)]),g(M,{onDelItem:i.delOrder,"del-id":a.delId,ref:"deleteModal"},null,8,["onDelItem","del-id"]),g($,{"check-order-data":a.checkOrderData,ref:"orderDetailModal"},null,8,["check-order-data"])],64)}const Ee=O(te,[["render",Pe]]);export{Ee as default};
