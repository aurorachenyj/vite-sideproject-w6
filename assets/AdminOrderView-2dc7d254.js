import{T as p}from"./Toast-3b91fd9e.js";import{D as P}from"./DelModal-85611a1a.js";import{M as y}from"./modal-869e6fea.js";import{_ as k,o as d,c as n,a as e,t as o,F as h,E as u,k as D,r as m,e as g,J as b,h as v}from"./index-abb58fd7.js";import"./base-component-e83e387d.js";const x={data(){return{modal:""}},props:["checkOrderData"],mounted(){this.modal=new y(this.$refs.orderModal)},watch:{},methods:{hideModal(){this.modal.hide()},showModal(){this.modal.show()}}},w={class:"modal fade",ref:"orderModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},C={class:"modal-dialog modal-lg"},V={class:"modal-content"},E=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"exampleModalLabel"},"訂單詳情"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),I={key:0,class:"modal-body"},A={class:"row"},T={class:"col"},N={class:"ms-3"},B=e("h4",null,"用戶資料",-1),R={class:"table"},S={class:"tbody"},U=e("th",{scope:"row"},"姓名",-1),F=e("th",{scope:"row"},"電話",-1),H=e("th",{scope:"row"},"email",-1),j=e("th",{scope:"row"},"付款方式",-1),q={class:"col"},z=e("h4",null,"訂單資料",-1),J={class:"table"},G={class:"tbody"},K=e("th",{scope:"row"},"訂單編號",-1),Q=e("th",{scope:"row"},"下單時間",-1),W=e("th",{scope:"row"},"總金額",-1),X=e("th",{scope:"row"},"訂購品項",-1),Y=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-primary text-white","data-bs-dismiss":"modal"}," 關閉 ")],-1);function Z(a,s,r,L,l,i){return d(),n("div",w,[e("div",C,[e("div",V,[E,r.checkOrderData.order?(d(),n("div",I,[e("div",A,[e("div",T,[e("div",N,[B,e("table",R,[e("div",S,[e("tr",null,[U,e("td",null,o(r.checkOrderData.order.user.name),1)]),e("tr",null,[F,e("td",null,o(r.checkOrderData.order.user.tel),1)]),e("tr",null,[H,e("td",null,o(r.checkOrderData.order.user.email),1)]),e("tr",null,[j,e("td",null,o(r.checkOrderData.order.user.payment),1)])])])])]),e("div",q,[z,e("table",J,[e("div",G,[e("tr",null,[K,e("td",null,o(r.checkOrderData.order.id),1)]),e("tr",null,[Q,e("td",null,o(new Date(r.checkOrderData.order.create_at*1e3).toLocaleDateString()),1)]),e("tr",null,[W,e("td",null,o(r.checkOrderData.order.total),1)]),e("tr",null,[X,e("td",null,[(d(!0),n(h,null,u(r.checkOrderData.order.products,_=>(d(),n("p",{key:_.id,class:"mb-0"},o(_.product.title),1))),128))])])])])])])])):D("",!0),Y])])],512)}const ee=k(x,[["render",Z]]),{VITE_APP_URL:f,VITE_APP_PATH:O}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"aurora-path",BASE_URL:"/vue-learnFund/",MODE:"production",DEV:!1,PROD:!0},te={data(){return{delId:"",checkOrderData:{},allOrderList:[],isLoading:!1,currentPage:1,totalOrderList:[],totalPage:1,courseStudentNumData:{}}},components:{DelModal:P,OrderDetailModal:ee},mounted(){this.getOrderList()},methods:{getOrderList(a=1){this.isLoading=!0,this.$http.get(`${f}/api/${O}/admin/orders?page=${a}`).then(s=>{this.isLoading=!1,p.fire({icon:"success",title:"成功取得資料"}),this.allOrderList=s.data,this.totalPage=s.data.pagination.total_pages}).catch(s=>{this.isLoading=!1,p.fire({icon:"error",title:s.response.data.message})})},changePage(a){a>this.totalPage||a===0||(this.currentPage=a,this.getOrderList(this.currentPage))},openDelModal(a){this.delId=a,this.$refs.deleteModal.showModal()},openOrderModal(a){this.isLoading=!0,this.$http.get(`${f}/api/${O}/order/${a}`).then(s=>{this.checkOrderData=s.data,this.isLoading=!1}).catch(()=>{this.isLoading=!1}),this.$refs.orderDetailModal.showModal()},delOrder(){const a=this.delId;this.$http.delete(`${f}/api/${O}/admin/order/${a}`).then(()=>{this.getOrderList(this.currentPage),this.$refs.deleteModal.hideModal()}).catch(s=>{p.fire({icon:"error",title:s.response.data.message})})}}},se=e("h3",{class:"text-center mt-5"},"訂單管理",-1),oe={class:"card mt-4"},ae={class:"card-body p-0"},le={class:"table-responsive text-nowrap"},de={class:"table table-hover"},ne=e("thead",{class:"border-bottom border-3 bg-light"},[e("tr",{class:"align-middle"},[e("th",{scope:"col ",class:"ps-3"}),e("th",{scope:"col",class:"py-3"},"訂單編號"),e("th",{scope:"col"},"Email"),e("th",{scope:"col"},"用戶名"),e("th",{scope:"col"},"購買品項"),e("th",{scope:"col",class:"text-end"},"付款方式"),e("th",{scope:"col",class:"text-end"},"金額"),e("th",{scope:"col",class:"text-end pe-3"},"訂單編輯")])],-1),re=e("td",{class:"py-3 ps-3"},null,-1),ie={class:""},ce={class:"ps-2 px-0 mb-0"},he={class:"text-end"},_e={class:"text-end"},ue={class:"text-end pe-3 text-danger"},pe={class:"btn-group",role:"group"},me=["onClick"],ge=["onClick"],be={key:0,class:"card-footer bg-transparent border-0 pb-0"},ve={"aria-label":"Page navigation mb-0 "},fe={class:"pagination justify-content-center"},Oe=e("a",{class:"page-link",href:"","aria-label":"Previous"},[e("span",{"aria-hidden":"true"},"«")],-1),ke=[Oe],De=["onClick"],Le={class:"page-link",href:"#"},Me=e("a",{class:"page-link","aria-label":"Next"},[e("span",{"aria-hidden":"true"},"»")],-1),$e=[Me];function Pe(a,s,r,L,l,i){const _=m("LoadingVue"),M=m("DelModal"),$=m("OrderDetailModal");return d(),n(h,null,[se,g(_,{active:l.isLoading,"onUpdate:active":s[0]||(s[0]=t=>l.isLoading=t)},null,8,["active"]),e("div",oe,[e("div",ae,[e("div",le,[e("table",de,[ne,e("tbody",null,[(d(!0),n(h,null,u(l.allOrderList.orders,t=>(d(),n("tr",{class:"align-middle",key:t.id},[re,e("td",ie,o(t.id),1),e("td",null,o(t.user.email),1),e("td",null,o(t.user.name),1),e("td",null,[e("ol",ce,[(d(!0),n(h,null,u(t.products,c=>(d(),n("li",{key:c.id},o(c.product.title),1))),128))])]),e("td",he,o(t.user.payment),1),e("td",_e,o(t.total),1),e("td",ue,[e("div",pe,[e("button",{onClick:c=>i.openOrderModal(t.id),type:"button",class:"btn btn-outline-dark btn-sm"}," 檢視 ",8,me),e("button",{onClick:c=>i.openDelModal(t.id),type:"button",class:"btn btn-outline-primary btn-sm"}," 刪除 ",8,ge)])])]))),128))])])])]),l.allOrderList.pagination?(d(),n("div",be,[e("nav",ve,[e("ul",fe,[e("li",{class:b(["page-item",{disabled:!l.allOrderList.pagination.has_pre}]),onClick:s[1]||(s[1]=v(t=>i.changePage(l.currentPage-1),["prevent"]))},ke,2),(d(!0),n(h,null,u(l.allOrderList.pagination.total_pages,t=>(d(),n("li",{class:b(["page-item",{active:t===l.currentPage}]),key:t+"hlllq",onClick:v(c=>i.changePage(t),["prevent"])},[e("a",Le,o(t),1)],10,De))),128)),e("li",{class:b(["page-item",{disabled:!l.allOrderList.pagination.has_next}]),onClick:s[2]||(s[2]=v(t=>i.changePage(l.currentPage+1),["prevent"]))},$e,2)])])])):D("",!0)]),g(M,{onDelItem:i.delOrder,"del-id":l.delId,ref:"deleteModal"},null,8,["onDelItem","del-id"]),g($,{"check-order-data":l.checkOrderData,ref:"orderDetailModal"},null,8,["check-order-data"])],64)}const Ee=k(te,[["render",Pe]]);export{Ee as default};
